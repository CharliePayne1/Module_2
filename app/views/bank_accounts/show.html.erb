<div class="row">
<div class="col s12 m6 l3"><p><%= button_to "All Customers", customers_path, method: :get %></p></div>
<div class="col s12 m6 l3"><p><%= button_to "All Bank Accounts", bank_accounts_path, method: :get %></p></div>
<div class="col s12 m6 l3"><p><%= button_to "All Retailers", retailers_path, method: :get %></p></div>
<div class="col s12 m6 l3"><p><%= button_to "All Transactions", receipts_path, method: :get %></p></div>
</div>

<h2> <%= link_to @bank_account.customer.full_name, customer_path(@bank_account.customer)  %><br> 
<%= @bank_account.type_of_account %> Account </h2> 

<h5> Account Number: <%= @bank_account.account_number %> | Sort Code: <%= @bank_account.sort_code %> <br>
<br>
Available Funds: £<%= @bank_account.available_funds %><br>
Balance: £<%= @bank_account.funds %> | Overdraft: £<%= @bank_account.overdraft %></h5> <br>
<br>
<br>

 <h5> Transactions Analytics </h5>
<h6><ul><% if @bank_account.receipts.length > 0 %>
 <li> Maximum spend: £ <%= @bank_account.retailer_spent_most_with.total_amount %> at <%= link_to @bank_account.retailer_spent_most_with.retailer.name, retailer_path(@bank_account.retailer_spent_most_with.retailer) %> 
 <button> <%= link_to "See Transaction", receipt_path(@bank_account.retailer_spent_most_with) %> </button> </li> 
 <li> Average Transactions: £ <%= @bank_account.avrg_transaction %> </li> 
      <% else %>
          <%= "Currently there are no transactions to display." %>
      <%end%>
  </h6></ul><br>
  <br>

  <class="collapsible">
    <div class="collapsible-header"><i class="material-icons">filter_drama</i>See Transaction</div>
    <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>


<br>
<h5>Recent Transactions</h5>
 <table>
        <thead>
           <tr>
            <th>Transaction ID</th>
            <th> Retailer </th>
                 <th>Value</th>
               <th>Date</th>
               <th>Items Purchased</th>
           </tr>
         </thead>
      <tbody>
           <tr>
           <% @bank_account.recent_transactions.each do |receipt| %>
             <td><%= receipt.id %></td>
             <td><%= link_to receipt.retailer.name, receipt_path(receipt) %></td>
             <td> £<%= receipt.total_amount.round(2) %></td>
             <td><%= receipt.created_at %></td>
             <td><%= receipt.items %></td>
           </tr>
         </tbody>
         <% end %>
 </table>

<br>
<br>
<br>
<br>



  <h5> Change Overdraft Limit</h5><br>
  <%= form_for @bank_account do |f| %>
  <%= f.label :overdraft %>
 
  <%= f.select :overdraft, options_for_select((0..2000).step(250)), {:style=>'display: block;'} %>
  <br>
  <br>
  <%= f.submit %>
  <%end%> 

  <br>
  <br>

  <%= button_to "Close Account", bank_account_path(@bank_account), method: :delete, data: { confirm: "Are you sure you want to delete this account?"} %><br>
  <%= button_to "Back", customer_path(@bank_account.customer), method: :get  %>
  
<br>
<br>
